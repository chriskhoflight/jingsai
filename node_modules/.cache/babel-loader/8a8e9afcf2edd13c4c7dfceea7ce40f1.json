{"remainingRequest":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\thread-loader\\dist\\cjs.js!D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\babel-loader\\lib\\index.js!D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\jingsai\\rcms_src\\rcms-pc-web\\src\\views\\sys\\quartz-manage\\quartzManage.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\src\\views\\sys\\quartz-manage\\quartzManage.vue","mtime":1564969187236},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getQuartzListData, addQuartz, editQuartz, pauseQuartz, resumeQuartz, deleteQuartz } from \"@/api/index\";\nimport circleLoading from \"@/views/components/custom/circle-loading.vue\";\nexport default {\n  name: \"quartz-manage\",\n  components: {\n    circleLoading: circleLoading\n  },\n  data: function data() {\n    var _this = this;\n\n    return {\n      loading: true,\n      operationLoading: false,\n      sortColumn: \"createTime\",\n      sortType: \"desc\",\n      modalType: 0,\n      modalVisible: false,\n      modalTitle: \"\",\n      form: {\n        id: \"\",\n        jobClassName: \"\",\n        cronExpression: \"\",\n        paramter: \"\",\n        description: \"\"\n      },\n      formValidate: {\n        jobClassName: [{\n          required: true,\n          message: \"任务类名不能为空\",\n          trigger: \"blur\"\n        }],\n        cronExpression: [{\n          required: true,\n          message: \"cron表达式不能为空\",\n          trigger: \"blur\"\n        }]\n      },\n      submitLoading: false,\n      selectList: [],\n      selectCount: 0,\n      columns: [{\n        type: \"selection\",\n        width: 60,\n        align: \"center\"\n      }, {\n        type: \"index\",\n        width: 60,\n        align: \"center\"\n      }, {\n        title: \"任务类名\",\n        key: \"jobClassName\",\n        sortable: true,\n        width: 200\n      }, {\n        title: \"cron表达式\",\n        key: \"cronExpression\",\n        sortable: true,\n        width: 200\n      }, {\n        title: \"参数\",\n        key: \"parameter\",\n        sortable: true,\n        width: 180\n      }, {\n        title: \"备注\",\n        key: \"description\",\n        sortable: true,\n        minWidth: 180\n      }, {\n        title: \"状态\",\n        key: \"status\",\n        align: \"center\",\n        width: 140,\n        render: function render(h, params) {\n          var re = \"\";\n\n          if (params.row.status === 0) {\n            return h(\"div\", [h(\"Tag\", {\n              props: {\n                type: \"dot\",\n                color: \"success\"\n              }\n            }, \"执行中\")]);\n          } else if (params.row.status === -1) {\n            return h(\"div\", [h(\"Tag\", {\n              props: {\n                type: \"dot\",\n                color: \"error\"\n              }\n            }, \"已停止\")]);\n          }\n        },\n        filters: [{\n          label: \"执行中\",\n          value: 0\n        }, {\n          label: \"已停止\",\n          value: -1\n        }],\n        filterMultiple: false,\n        filterMethod: function filterMethod(value, row) {\n          if (value === 0) {\n            return row.status === 0;\n          } else if (value === -1) {\n            return row.status === -1;\n          }\n        }\n      }, {\n        title: \"操作\",\n        key: \"action\",\n        align: \"center\",\n        width: 280,\n        render: function render(h, params) {\n          var runOrResume = \"\";\n\n          if (params.row.status == 0) {\n            runOrResume = h(\"Button\", {\n              props: {\n                type: \"warning\",\n                size: \"small\",\n                icon: \"md-pause\"\n              },\n              style: {\n                marginRight: \"5px\"\n              },\n              on: {\n                click: function click() {\n                  _this.pause(params.row);\n                }\n              }\n            }, \"暂停\");\n          } else {\n            runOrResume = h(\"Button\", {\n              props: {\n                type: \"success\",\n                size: \"small\",\n                icon: \"md-play\"\n              },\n              style: {\n                marginRight: \"5px\"\n              },\n              on: {\n                click: function click() {\n                  _this.resume(params.row);\n                }\n              }\n            }, \"恢复执行\");\n          }\n\n          return h(\"div\", [runOrResume, h(\"Button\", {\n            props: {\n              type: \"primary\",\n              size: \"small\"\n            },\n            style: {\n              marginRight: \"5px\"\n            },\n            on: {\n              click: function click() {\n                _this.edit(params.row);\n              }\n            }\n          }, \"编辑\"), h(\"Button\", {\n            props: {\n              type: \"error\",\n              size: \"small\"\n            },\n            on: {\n              click: function click() {\n                _this.remove(params.row);\n              }\n            }\n          }, \"删除\")]);\n        }\n      }],\n      data: [],\n      pageNumber: 1,\n      pageSize: 10,\n      total: 0\n    };\n  },\n  methods: {\n    init: function init() {\n      this.getQuartzList();\n    },\n    changePage: function changePage(v) {\n      this.pageNumber = v;\n      this.getQuartzList();\n      this.clearSelectAll();\n    },\n    changePageSize: function changePageSize(v) {\n      this.pageSize = v;\n      this.getQuartzList();\n    },\n    changeSort: function changeSort(e) {\n      this.sortColumn = e.key;\n      this.sortType = e.order;\n\n      if (e.order === \"normal\") {\n        this.sortType = \"\";\n      }\n\n      this.getQuartzList();\n    },\n    getQuartzList: function getQuartzList() {\n      var _this2 = this;\n\n      this.loading = true;\n      var params = {\n        pageNumber: this.pageNumber,\n        pageSize: this.pageSize,\n        sort: this.sortColumn,\n        order: this.sortType\n      };\n      getQuartzListData(params).then(function (res) {\n        _this2.loading = false;\n\n        if (res.success === true) {\n          _this2.data = res.result.content;\n          _this2.total = res.result.totalElements;\n        }\n      });\n    },\n    cancelSubmit: function cancelSubmit() {\n      this.modalVisible = false;\n    },\n    handleSubmit: function handleSubmit() {\n      var _this3 = this;\n\n      this.$refs.form.validate(function (valid) {\n        if (valid) {\n          if (_this3.modalType === 0) {\n            // 添加\n            _this3.submitLoading = true;\n            addQuartz(_this3.form).then(function (res) {\n              _this3.submitLoading = false;\n\n              if (res.success === true) {\n                _this3.$Message.success(\"操作成功\");\n\n                _this3.getQuartzList();\n\n                _this3.modalVisible = false;\n              }\n            });\n          } else {\n            _this3.submitLoading = true;\n            editQuartz(_this3.form).then(function (res) {\n              _this3.submitLoading = false;\n\n              if (res.success === true) {\n                _this3.$Message.success(\"操作成功\");\n\n                _this3.getQuartzList();\n\n                _this3.modalVisible = false;\n              }\n            });\n          }\n        }\n      });\n    },\n    addRole: function addRole() {\n      this.modalType = 0;\n      this.modalTitle = \"添加任务\";\n      this.$refs.form.resetFields();\n      this.form = {\n        paramter: \"\",\n        description: \"\"\n      }, this.modalVisible = true;\n    },\n    edit: function edit(v) {\n      this.modalType = 1;\n      this.modalTitle = \"编辑任务\"; // 转换null为\"\"\n\n      for (var attr in v) {\n        if (v[attr] === null) {\n          v[attr] = \"\";\n        }\n      }\n\n      var str = JSON.stringify(v);\n      var data = JSON.parse(str);\n      this.form = data;\n      this.modalVisible = true;\n    },\n    pause: function pause(v) {\n      var _this4 = this;\n\n      this.$Modal.confirm({\n        title: \"确认停止\",\n        content: \"您确认要停止任务 \" + v.jobClassName + \" ?\",\n        onOk: function onOk() {\n          _this4.operationLoading = true;\n          pauseQuartz(v).then(function (res) {\n            _this4.operationLoading = false;\n\n            if (res.success === true) {\n              _this4.$Message.success(\"操作成功\");\n\n              _this4.getQuartzList();\n            }\n          });\n        }\n      });\n    },\n    resume: function resume(v) {\n      var _this5 = this;\n\n      this.$Modal.confirm({\n        title: \"确认恢复\",\n        content: \"您确认要恢复任务 \" + v.jobClassName + \" ?\",\n        onOk: function onOk() {\n          _this5.operationLoading = true;\n          resumeQuartz(v).then(function (res) {\n            _this5.operationLoading = false;\n\n            if (res.success === true) {\n              _this5.$Message.success(\"操作成功\");\n\n              _this5.getQuartzList();\n            }\n          });\n        }\n      });\n    },\n    remove: function remove(v) {\n      var _this6 = this;\n\n      this.$Modal.confirm({\n        title: \"确认删除\",\n        content: \"您确认要删除任务 \" + v.jobClassName + \" ?\",\n        onOk: function onOk() {\n          _this6.operationLoading = true;\n          deleteQuartz(v.id).then(function (res) {\n            _this6.operationLoading = false;\n\n            if (res.success === true) {\n              _this6.$Message.success(\"操作成功\");\n\n              _this6.getQuartzList();\n            }\n          });\n        }\n      });\n    },\n    clearSelectAll: function clearSelectAll() {\n      this.$refs.table.selectAll(false);\n    },\n    changeSelect: function changeSelect(e) {\n      this.selectList = e;\n      this.selectCount = e.length;\n    },\n    delAll: function delAll() {\n      var _this7 = this;\n\n      if (this.selectCount <= 0) {\n        this.$Message.warning(\"您还未选择要删除的数据\");\n        return;\n      }\n\n      this.$Modal.confirm({\n        title: \"确认删除\",\n        content: \"您确认要删除所选的 \" + this.selectCount + \" 条数据?\",\n        onOk: function onOk() {\n          var ids = \"\";\n\n          _this7.selectList.forEach(function (e) {\n            ids += e.id + \",\";\n          });\n\n          ids = ids.substring(0, ids.length - 1);\n          _this7.operationLoading = true;\n          deleteQuartz(ids).then(function (res) {\n            _this7.operationLoading = false;\n\n            if (res.success === true) {\n              _this7.$Message.success(\"删除成功\");\n\n              _this7.clearSelectAll();\n\n              _this7.getQuartzList();\n            }\n          });\n        }\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.init();\n  }\n};",null]}