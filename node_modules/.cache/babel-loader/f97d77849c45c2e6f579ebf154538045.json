{"remainingRequest":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\thread-loader\\dist\\cjs.js!D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\babel-loader\\lib\\index.js!D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\jingsai\\rcms_src\\rcms-pc-web\\src\\views\\sys\\redis\\redis.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\src\\views\\sys\\redis\\redis.vue","mtime":1564969187236},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getRedisData, saveRedis, deleteRedis, deleteAllRedis, getRedisByKey } from \"@/api/index\";\nimport circleLoading from \"@/views/components/custom/circle-loading.vue\";\nimport redisMonitor from \"./redisMonitor.vue\";\nexport default {\n  name: \"redis-notCache\",\n  components: {\n    circleLoading: circleLoading,\n    redisMonitor: redisMonitor\n  },\n  data: function data() {\n    var _this = this;\n\n    return {\n      loading: true,\n      // 表单加载状态\n      operationLoading: false,\n      // 操作加载状态\n      modalType: 0,\n      // 添加或编辑标识\n      modalVisible: false,\n      // 添加或编辑显示\n      modalTitle: \"\",\n      // 添加或编辑标题\n      searchForm: {\n        // 搜索框初始化对象\n        pageNumber: 1,\n        // 当前页数\n        pageSize: 10,\n        // 页面大小\n        sort: \"createTime\",\n        // 默认排序字段\n        order: \"desc\" // 默认排序方式\n\n      },\n      form: {\n        // 添加或编辑表单对象初始化数据\n        key: \"\",\n        value: \"\"\n      },\n      // 表单验证规则\n      formValidate: {\n        key: [{\n          required: true,\n          message: \"不能为空\",\n          trigger: \"blur\"\n        }],\n        value: [{\n          required: true,\n          message: \"不能为空\",\n          trigger: \"blur\"\n        }]\n      },\n      submitLoading: false,\n      // 添加或编辑提交状态\n      selectList: [],\n      // 多选数据\n      selectCount: 0,\n      // 多选计数\n      columns: [// 表头\n      {\n        type: \"selection\",\n        width: 60,\n        align: \"center\"\n      }, {\n        type: \"index\",\n        width: 60,\n        align: \"center\"\n      }, {\n        title: \"Key\",\n        key: \"key\",\n        minWidth: 100,\n        sortable: true\n      }, {\n        title: \"Value\",\n        key: \"value\",\n        minWidth: 300,\n        ellipsis: true\n      }, {\n        title: \"操作\",\n        key: \"action\",\n        align: \"center\",\n        width: 200,\n        render: function render(h, params) {\n          return h(\"div\", [h(\"Button\", {\n            props: {\n              type: \"primary\",\n              size: \"small\",\n              icon: \"ios-create-outline\"\n            },\n            style: {\n              marginRight: \"5px\"\n            },\n            on: {\n              click: function click() {\n                _this.edit(params.row);\n              }\n            }\n          }, \"编辑\"), h(\"Button\", {\n            props: {\n              type: \"error\",\n              size: \"small\",\n              icon: \"md-trash\"\n            },\n            on: {\n              click: function click() {\n                _this.remove(params.row);\n              }\n            }\n          }, \"删除\")]);\n        }\n      }],\n      data: [],\n      // 表单数据\n      pageNumber: 1,\n      // 当前页数\n      pageSize: 10,\n      // 页面大小\n      total: 0 // 表单数据总数\n\n    };\n  },\n  methods: {\n    init: function init() {\n      this.getDataList();\n    },\n    handleClickTab: function handleClickTab(name) {\n      if (name == \"monitor\") {\n        this.$Message.info(\"每隔5秒刷新一次数据，请耐心等待图表绘制\");\n      }\n    },\n    changePage: function changePage(v) {\n      this.searchForm.pageNumber = v;\n      this.getDataList();\n      this.clearSelectAll();\n    },\n    changePageSize: function changePageSize(v) {\n      this.searchForm.pageSize = v;\n      this.getDataList();\n    },\n    handleSearch: function handleSearch() {\n      this.searchForm.pageNumber = 1;\n      this.searchForm.pageSize = 10;\n      this.getDataList();\n    },\n    handleReset: function handleReset() {\n      this.$refs.searchForm.resetFields();\n      this.searchForm.pageNumber = 1;\n      this.searchForm.pageSize = 10; // 重新加载数据\n\n      this.getDataList();\n    },\n    changeSort: function changeSort(e) {\n      this.searchForm.sort = e.key;\n      this.searchForm.order = e.order;\n\n      if (e.order == \"normal\") {\n        this.searchForm.order = \"\";\n      }\n\n      this.getDataList();\n    },\n    clearSelectAll: function clearSelectAll() {\n      this.$refs.table.selectAll(false);\n    },\n    changeSelect: function changeSelect(e) {\n      this.selectList = e;\n      this.selectCount = e.length;\n    },\n    getDataList: function getDataList() {\n      var _this2 = this;\n\n      this.loading = true;\n      getRedisData(this.searchForm).then(function (res) {\n        _this2.loading = false;\n\n        if (res.success == true) {\n          _this2.data = res.result.content;\n          _this2.total = res.result.totalElements;\n        }\n      });\n    },\n    handleSubmit: function handleSubmit() {\n      var _this3 = this;\n\n      this.$refs.form.validate(function (valid) {\n        if (valid) {\n          _this3.submitLoading = true; // 添加或编辑\n\n          saveRedis(_this3.form).then(function (res) {\n            _this3.submitLoading = false;\n\n            if (res.success == true) {\n              _this3.$Message.success(\"操作成功\");\n\n              _this3.getDataList();\n\n              _this3.modalVisible = false;\n            }\n          });\n        }\n      });\n    },\n    add: function add() {\n      this.modalType = 0;\n      this.modalTitle = \"添加\";\n      this.$refs.form.resetFields();\n      delete this.form.id;\n      this.modalVisible = true;\n    },\n    edit: function edit(v) {\n      var _this4 = this;\n\n      this.modalType = 1;\n      this.modalTitle = \"编辑\";\n      this.$refs.form.resetFields(); // 转换null为\"\"\n\n      for (var attr in v) {\n        if (v[attr] == null) {\n          v[attr] = \"\";\n        }\n      }\n\n      var str = JSON.stringify(v);\n      var data = JSON.parse(str);\n      this.form.value = \"读取中...\";\n      getRedisByKey(data.key).then(function (res) {\n        _this4.form.value = \"\";\n\n        if (res.success) {\n          data.value = res.result;\n          _this4.form = data;\n        }\n      });\n      this.modalVisible = true;\n    },\n    clear: function clear(v) {\n      var _this5 = this;\n\n      this.$Modal.confirm({\n        title: \"请谨慎进行此操作！\",\n        content: \"您确认要彻底清空删除所有数据?\",\n        onOk: function onOk() {\n          // 删除\n          _this5.operationLoading = true;\n          deleteAllRedis().then(function (res) {\n            _this5.operationLoading = false;\n\n            if (res.success == true) {\n              _this5.$Message.success(\"操作成功\");\n\n              _this5.getDataList();\n            }\n          });\n        }\n      });\n    },\n    remove: function remove(v) {\n      var _this6 = this;\n\n      this.$Modal.confirm({\n        title: \"确认删除\",\n        // 记得确认修改此处\n        content: \"您确认要删除 \" + v.key + \" ?\",\n        onOk: function onOk() {\n          // 删除\n          _this6.operationLoading = true;\n          deleteRedis({\n            keys: v.key\n          }).then(function (res) {\n            _this6.operationLoading = false;\n\n            if (res.success == true) {\n              _this6.$Message.success(\"操作成功\");\n\n              _this6.getDataList();\n            }\n          });\n        }\n      });\n    },\n    delAll: function delAll() {\n      var _this7 = this;\n\n      if (this.selectCount <= 0) {\n        this.$Message.warning(\"您还未选择要删除的数据\");\n        return;\n      }\n\n      this.$Modal.confirm({\n        title: \"确认删除\",\n        content: \"您确认要删除所选的 \" + this.selectCount + \" 条数据?\",\n        onOk: function onOk() {\n          var keys = \"\";\n\n          _this7.selectList.forEach(function (e) {\n            keys += e.key + \",\";\n          });\n\n          keys = keys.substring(0, keys.length - 1); // 批量删除\n\n          _this7.operationLoading = true;\n          deleteRedis({\n            keys: keys\n          }).then(function (res) {\n            _this7.operationLoading = false;\n\n            if (res.success == true) {\n              _this7.$Message.success(\"操作成功\");\n\n              _this7.clearSelectAll();\n\n              _this7.getDataList();\n            }\n          });\n        }\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.init();\n  }\n};",null]}