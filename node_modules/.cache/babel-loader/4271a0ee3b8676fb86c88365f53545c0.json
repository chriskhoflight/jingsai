{"remainingRequest":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\babel-loader\\lib\\index.js!D:\\jingsai\\rcms_src\\rcms-pc-web\\src\\libs\\axios.js","dependencies":[{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\src\\libs\\axios.js","mtime":1564969187138},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.uploadFileRequest = exports.deleteRequest = exports.putRequest = exports.postRequest = exports.getRequest = void 0;\n\nvar _axios = _interopRequireDefault(require(\"axios\"));\n\nvar _storage = require(\"./storage\");\n\nvar _index = require(\"../router/index\");\n\nvar _iview = require(\"iview\");\n\nvar _jsCookie = _interopRequireDefault(require(\"js-cookie\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// 统一请求路径前缀\nvar base = process.env.VUE_APP_BASE_API; // 超时设定\n\n_axios.default.defaults.timeout = 15000;\n\n_axios.default.interceptors.request.use(function (config) {\n  return config;\n}, function (err) {\n  _iview.Message.error('请求超时');\n\n  return Promise.resolve(err);\n}); // http response 拦截器\n\n\n_axios.default.interceptors.response.use(function (response) {\n  var data = response.data; // 根据返回的code值来做不同的处理(和后端约定)\n\n  switch (data.code) {\n    case 401:\n      // 未登录 清除已登录状态\n      _jsCookie.default.set('userInfo', '');\n\n      (0, _storage.setStore)('accessToken', '');\n\n      _index.router.push('/login');\n\n      break;\n\n    case 403:\n      // 没有权限\n      if (data.message !== null) {\n        _iview.Message.error(data.message);\n      } else {\n        _iview.Message.error(\"未知错误\");\n      }\n\n      break;\n\n    case 500:\n      // 错误\n      if (data.message !== null) {\n        _iview.Message.error(data.message);\n      } else {\n        _iview.Message.error(\"未知错误\");\n      }\n\n      break;\n\n    default:\n      return data;\n  }\n\n  return data;\n}, function (err) {\n  // 返回状态码不为200时候的错误处理\n  _iview.Message.error(err.toString());\n\n  return Promise.resolve(err);\n});\n\nvar getRequest = function getRequest(url, params) {\n  var accessToken = (0, _storage.getStore)('accessToken');\n  return (0, _axios.default)({\n    method: 'get',\n    url: \"\".concat(base).concat(url),\n    params: params,\n    headers: {\n      'accessToken': accessToken\n    }\n  });\n};\n\nexports.getRequest = getRequest;\n\nvar postRequest = function postRequest(url, params) {\n  var accessToken = (0, _storage.getStore)(\"accessToken\");\n  return (0, _axios.default)({\n    method: 'post',\n    url: \"\".concat(base).concat(url),\n    data: params,\n    transformRequest: [function (data) {\n      var ret = '';\n\n      for (var it in data) {\n        ret += encodeURIComponent(it) + '=' + encodeURIComponent(data[it]) + '&';\n      }\n\n      return ret;\n    }],\n    headers: {\n      'Content-Type': 'application/x-www-form-urlencoded',\n      'accessToken': accessToken\n    }\n  });\n};\n\nexports.postRequest = postRequest;\n\nvar putRequest = function putRequest(url, params) {\n  var accessToken = (0, _storage.getStore)(\"accessToken\");\n  return (0, _axios.default)({\n    method: 'put',\n    url: \"\".concat(base).concat(url),\n    data: params,\n    transformRequest: [function (data) {\n      var ret = '';\n\n      for (var it in data) {\n        ret += encodeURIComponent(it) + '=' + encodeURIComponent(data[it]) + '&';\n      }\n\n      return ret;\n    }],\n    headers: {\n      'Content-Type': 'application/x-www-form-urlencoded',\n      'accessToken': accessToken\n    }\n  });\n};\n\nexports.putRequest = putRequest;\n\nvar deleteRequest = function deleteRequest(url, params) {\n  var accessToken = (0, _storage.getStore)('accessToken');\n  return (0, _axios.default)({\n    method: 'delete',\n    url: \"\".concat(base).concat(url),\n    params: params,\n    headers: {\n      'accessToken': accessToken\n    }\n  });\n};\n\nexports.deleteRequest = deleteRequest;\n\nvar uploadFileRequest = function uploadFileRequest(url, params) {\n  var accessToken = (0, _storage.getStore)('accessToken');\n  return (0, _axios.default)({\n    method: 'post',\n    url: \"\".concat(base).concat(url),\n    params: params,\n    headers: {\n      'accessToken': accessToken\n    }\n  });\n};\n\nexports.uploadFileRequest = uploadFileRequest;",{"version":3,"sources":["D:\\jingsai\\rcms_src\\rcms-pc-web\\src\\libs\\axios.js"],"names":["base","process","env","VUE_APP_BASE_API","axios","defaults","timeout","interceptors","request","use","config","err","Message","error","Promise","resolve","response","data","code","Cookies","set","router","push","message","toString","getRequest","url","params","accessToken","method","headers","postRequest","transformRequest","ret","it","encodeURIComponent","putRequest","deleteRequest","uploadFileRequest"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport { getStore, setStore } from './storage';\r\nimport { router } from '../router/index';\r\nimport { Message } from 'iview';\r\nimport Cookies from 'js-cookie';\r\n// 统一请求路径前缀\r\nlet base = process.env.VUE_APP_BASE_API;\r\n// 超时设定\r\naxios.defaults.timeout = 15000;\r\n\r\naxios.interceptors.request.use(config => {\r\n    return config;\r\n}, err => {\r\n    Message.error('请求超时');\r\n    return Promise.resolve(err);\r\n});\r\n\r\n// http response 拦截器\r\naxios.interceptors.response.use(response => {\r\n    const data = response.data;\r\n\r\n    // 根据返回的code值来做不同的处理(和后端约定)\r\n    switch (data.code) {\r\n        case 401:\r\n            // 未登录 清除已登录状态\r\n            Cookies.set('userInfo', '');\r\n            setStore('accessToken', '');\r\n            router.push('/login');\r\n            break;\r\n        case 403:\r\n            // 没有权限\r\n            if (data.message !== null) {\r\n                Message.error(data.message);\r\n            } else {\r\n                Message.error(\"未知错误\");\r\n            }\r\n            break;\r\n        case 500:\r\n            // 错误\r\n            if (data.message !== null) {\r\n                Message.error(data.message);\r\n            } else {\r\n                Message.error(\"未知错误\");\r\n            }\r\n            break;\r\n        default:\r\n            return data;\r\n    }\r\n\r\n    return data;\r\n}, (err) => {\r\n    // 返回状态码不为200时候的错误处理\r\n    Message.error(err.toString());\r\n    return Promise.resolve(err);\r\n});\r\n\r\nexport const getRequest = (url, params) => {\r\n    let accessToken = getStore('accessToken');\r\n    return axios({\r\n        method: 'get',\r\n        url: `${base}${url}`,\r\n        params: params,\r\n        headers: {\r\n            'accessToken': accessToken\r\n        }\r\n    });\r\n};\r\n\r\nexport const postRequest = (url, params) => {\r\n    let accessToken = getStore(\"accessToken\");\r\n    return axios({\r\n        method: 'post',\r\n        url: `${base}${url}`,\r\n        data: params,\r\n        transformRequest: [function (data) {\r\n            let ret = '';\r\n            for (let it in data) {\r\n                ret += encodeURIComponent(it) + '=' + encodeURIComponent(data[it]) + '&';\r\n            }\r\n            return ret;\r\n        }],\r\n        headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n            'accessToken': accessToken\r\n        }\r\n    });\r\n};\r\n\r\nexport const putRequest = (url, params) => {\r\n    let accessToken = getStore(\"accessToken\");\r\n    return axios({\r\n        method: 'put',\r\n        url: `${base}${url}`,\r\n        data: params,\r\n        transformRequest: [function (data) {\r\n            let ret = '';\r\n            for (let it in data) {\r\n                ret += encodeURIComponent(it) + '=' + encodeURIComponent(data[it]) + '&';\r\n            }\r\n            return ret;\r\n        }],\r\n        headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n            'accessToken': accessToken\r\n        }\r\n    });\r\n};\r\n\r\nexport const deleteRequest = (url, params) => {\r\n    let accessToken = getStore('accessToken');\r\n    return axios({\r\n        method: 'delete',\r\n        url: `${base}${url}`,\r\n        params: params,\r\n        headers: {\r\n            'accessToken': accessToken\r\n        }\r\n    });\r\n};\r\n\r\nexport const uploadFileRequest = (url, params) => {\r\n    let accessToken = getStore('accessToken');\r\n    return axios({\r\n        method: 'post',\r\n        url: `${base}${url}`,\r\n        params: params,\r\n        headers: {\r\n            'accessToken': accessToken\r\n        }\r\n    });\r\n};\r\n"]}]}