{"remainingRequest":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\babel-loader\\lib\\index.js!D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\jingsai\\rcms_src\\rcms-pc-web\\src\\views\\login\\regist.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\src\\views\\login\\regist.vue","mtime":1564969187221},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\jingsai\\rcms_src\\rcms-pc-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _index = require(\"@/api/index\");\n\nvar _jsCookie = _interopRequireDefault(require(\"js-cookie\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  data: function data() {\n    var _this = this;\n\n    var validatePassword = function validatePassword(rule, value, callback) {\n      if (value.length < 6) {\n        callback(new Error(\"密码长度不得小于6位\"));\n      } else {\n        callback();\n      }\n    };\n\n    var validateConfirmPass = function validateConfirmPass(rule, value, callback) {\n      if (value.length < 6) {\n        callback(new Error(\"密码长度不得小于6位\"));\n      } else if (value !== _this.form.password) {\n        callback(new Error(\"两次输入的密码不一致\"));\n      } else {\n        callback();\n      }\n    };\n\n    var validateMobile = function validateMobile(rule, value, callback) {\n      var reg = /^[1][3,4,5,6,7,8][0-9]{9}$/;\n\n      if (!reg.test(value)) {\n        callback(new Error(\"手机号格式错误\"));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      captchaId: \"\",\n      verifyCodeImg: \"\",\n      error: false,\n      errorMsg: \"\",\n      loading: false,\n      loadingCode: true,\n      sended: false,\n      count: 60,\n      countButton: \"60 s\",\n      tipStyle: \"password-tip-none\",\n      strength: \"无\",\n      select: \"86\",\n      strengthValue: 0,\n      errorCode: \"\",\n      form: {\n        username: \"\",\n        password: \"\",\n        confirmPass: \"\",\n        mobile: \"\",\n        verifyCode: \"\",\n        verify: \"\"\n      },\n      rules: {\n        username: [{\n          required: true,\n          message: \"账号不能为空\",\n          trigger: \"blur\"\n        }],\n        password: [{\n          required: true,\n          message: \"密码不能为空\",\n          trigger: \"blur\"\n        }, {\n          validator: validatePassword,\n          trigger: \"blur\"\n        }],\n        confirmPass: [{\n          required: true,\n          message: \"确认密码不能为空\",\n          trigger: \"blur\"\n        }, {\n          validator: validateConfirmPass,\n          trigger: \"blur\"\n        }],\n        mobile: [{\n          required: true,\n          message: \"手机号不能为空\",\n          trigger: \"blur\"\n        }, {\n          validator: validateMobile,\n          trigger: \"blur\"\n        }],\n        verify: [{\n          required: true,\n          message: \"验证码不能为空\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n  methods: {\n    showErrorMsg: function showErrorMsg(msg) {\n      this.error = true;\n      this.errorMsg = msg;\n    },\n    checkStrengthValue: function checkStrengthValue(v) {\n      // 评级制判断密码强度 最高5\n      var grade = 0;\n\n      if (/\\d/.test(v)) {\n        grade++; //数字\n      }\n\n      if (/[a-z]/.test(v)) {\n        grade++; //小写\n      }\n\n      if (/[A-Z]/.test(v)) {\n        grade++; //大写\n      }\n\n      if (/\\W/.test(v)) {\n        grade++; //特殊字符\n      }\n\n      if (v.length >= 10) {\n        grade++;\n      }\n\n      return grade;\n    },\n    strengthChange: function strengthChange() {\n      if (!this.form.password) {\n        this.tipStyle = \"password-tip-none\";\n        this.strength = \"无\";\n        this.strengthValue = 0;\n        return;\n      }\n\n      var grade = this.checkStrengthValue(this.form.password);\n\n      if (grade <= 1) {\n        this.tipStyle = \"password-tip-weak\";\n        this.strength = \"弱\";\n        this.strengthValue = 33;\n      } else if (grade >= 2 && grade <= 4) {\n        this.tipStyle = \"password-tip-middle\";\n        this.strength = \"中\";\n        this.strengthValue = 66;\n      } else {\n        this.tipStyle = \"password-tip-strong\";\n        this.strength = \"强\";\n        this.strengthValue = 100;\n      }\n    },\n    sendVerify: function sendVerify() {\n      var _this2 = this;\n\n      this.$refs.registForm.validate(function (valid) {\n        if (valid) {\n          _this2.sended = true;\n\n          _this2.countDown();\n        }\n      });\n    },\n    countDown: function countDown() {\n      var that = this;\n\n      if (this.count === 0) {\n        this.sended = false;\n        this.count = 60;\n        return;\n      } else {\n        this.countButton = this.count + \" s\";\n        this.count--;\n      }\n\n      setTimeout(function () {\n        that.countDown();\n      }, 1000);\n    },\n    submitRegist: function submitRegist() {\n      var _this3 = this;\n\n      this.$refs.registForm.validate(function (valid) {\n        if (valid) {\n          if (_this3.form.verifyCode === \"\") {\n            _this3.errorCode = \"验证码不能为空\";\n            return;\n          } else {\n            _this3.errorCode = \"\";\n          }\n\n          _this3.loading = true;\n          _this3.form.captchaId = _this3.captchaId;\n          _this3.form.passStrength = _this3.strength;\n          (0, _index.regist)(_this3.form).then(function (res) {\n            _this3.loading = false;\n\n            if (res.success === true) {\n              var query = {\n                username: _this3.form.username\n              };\n\n              _this3.$router.push({\n                name: \"regist-result\",\n                query: query\n              });\n            } else {\n              _this3.getVerifyCode();\n            }\n          });\n        }\n      });\n    },\n    getVerifyCode: function getVerifyCode() {\n      var _this4 = this;\n\n      this.loadingCode = true;\n      (0, _index.initCaptcha)().then(function (res) {\n        if (res.success === true) {\n          _this4.captchaId = res.result.captchaId;\n          _this4.verifyCodeImg = _index.drawCodeImage + _this4.captchaId;\n          _this4.loadingCode = false;\n        }\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.getVerifyCode();\n  }\n};\nexports.default = _default;",{"version":3,"sources":["regist.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <Row type=\"flex\" justify=\"center\" align=\"middle\" class=\"regist\" @keydown.enter.native=\"submitRegist\">\r\n    <Col :xs=\"{span:22}\" style=\"width: 368px;\">\r\n    <Row class=\"header\">\r\n      <!-- <img src=\"@/assets/logo-min.jpg\" width=\"220px\" /> -->\r\n    </Row>\r\n  \r\n    <Alert type=\"error\" show-icon v-if=\"error\">{{errorMsg}}</Alert>\r\n  \r\n    <Row class=\"regist-form\">\r\n      <Form ref=\"registForm\" :model=\"form\" :rules=\"rules\" class=\"form\">\r\n        <span class=\"regist-title\">\r\n                          注册\r\n                      </span>\r\n        <FormItem prop=\"username\">\r\n          <Input v-model=\"form.username\" :maxlength=\"30\" size=\"large\" clearable placeholder=\"请输入用户名\" />\r\n        </FormItem>\r\n        <FormItem prop=\"password\">\r\n          <Poptip trigger=\"focus\" placement=\"right\" width=\"250\">\r\n            <Input type=\"password\" :maxlength=\"20\" v-model=\"form.password\" @on-change=\"strengthChange\" size=\"large\" clearable placeholder=\"请输入密码，长度为6-20个字符\" />\r\n            <div v-bind:class=\"tipStyle\" slot=\"content\">\r\n              <span class=\"words\">强度 : {{strength}}</span>\r\n              <Slider v-model=\"strengthValue\" :step=\"33\" style=\"width:95%\"></Slider>\r\n              请至少输入 6 个字符。请不要使<br>用容易被猜到的密码。\r\n            </div>\r\n          </Poptip>\r\n        </FormItem>\r\n        <FormItem prop=\"confirmPass\">\r\n          <Input type=\"password\" :maxlength=\"20\" v-model=\"form.confirmPass\" size=\"large\" clearable placeholder=\"请再次输入确认密码\" />\r\n        </FormItem>\r\n        <FormItem prop=\"mobile\">\r\n          <Input v-model=\"form.mobile\" size=\"large\" clearable placeholder=\"请输入手机号\">\r\n          <Select v-model=\"select\" slot=\"prepend\" style=\"width: 70px\">\r\n                              <Option value=\"86\">+86</Option>\r\n                            </Select>\r\n          </Input>\r\n        </FormItem>\r\n        <FormItem prop=\"verifyCode\" :error=\"errorCode\">\r\n          <Row type=\"flex\" justify=\"space-between\" class=\"code-row-bg\">\r\n            <Input v-model=\"form.verifyCode\" size=\"large\" clearable placeholder=\"请输入短信验证码(随意输入即可)\" :maxlength=\"10\" class=\"input-verify\" />\r\n            <Button size=\"large\" @click=\"sendVerify\" v-if=\"!sended\" class=\"send-verify\">获取验证码</Button>\r\n            <Button size=\"large\" disabled v-if=\"sended\" class=\"count-verify\">{{countButton}}</Button>\r\n          </Row>\r\n        </FormItem>\r\n        <FormItem prop=\"verify\">\r\n          <Row type=\"flex\" justify=\"space-between\" class=\"code-row-bg\" style=\"align-items: center;overflow: hidden;\">\r\n            <Input v-model=\"form.verify\" size=\"large\" clearable placeholder=\"请输入验证码\" :maxlength=\"10\" class=\"input-verify\" />\r\n            <div style=\"position:relative\">\r\n              <Spin v-if=\"loadingCode\" fix></Spin>\r\n              <img :src=\"verifyCodeImg\"  @click=\"getVerifyCode\" alt=\"加载验证码失败\" style=\"width:100px;cursor:pointer;display:block\">\r\n            </div>\r\n  \r\n          </Row>\r\n        </FormItem>\r\n      </Form>\r\n  \r\n      <Row type=\"flex\" justify=\"space-between\" class=\"code-row-bg\">\r\n        <Button class=\"regist-btn\" type=\"primary\" size=\"large\" :loading=\"loading\" @click=\"submitRegist\">\r\n                          <span v-if=\"!loading\">注册</span>\r\n                          <span v-else>注册中...</span>\r\n                      </Button>\r\n        <router-link to=\"/login\"><a class=\"to-login\">使用已有账号登录</a></router-link>\r\n      </Row>\r\n    </Row>\r\n  \r\n    <Row class=\"foot\">\r\n      <Row type=\"flex\" justify=\"center\" class=\"code-row-bg copyright\">\r\n        Copyright © 2019 - Present <a href=\"#\" target=\"_blank\" style=\"margin:0 5px;\">景云</a> 版权所有\r\n      </Row>\r\n    </Row>\r\n    </Col>\r\n  </Row>\r\n</template>\r\n\r\n<script>\r\nimport { regist, initCaptcha, drawCodeImage } from \"@/api/index\";\r\nimport Cookies from \"js-cookie\";\r\nexport default {\r\n  data() {\r\n    const validatePassword = (rule, value, callback) => {\r\n      if (value.length < 6) {\r\n        callback(new Error(\"密码长度不得小于6位\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    const validateConfirmPass = (rule, value, callback) => {\r\n      if (value.length < 6) {\r\n        callback(new Error(\"密码长度不得小于6位\"));\r\n      } else if (value !== this.form.password) {\r\n        callback(new Error(\"两次输入的密码不一致\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    const validateMobile = (rule, value, callback) => {\r\n      var reg = /^[1][3,4,5,6,7,8][0-9]{9}$/;\r\n      if (!reg.test(value)) {\r\n        callback(new Error(\"手机号格式错误\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    return {\r\n      captchaId: \"\",\r\n      verifyCodeImg: \"\",\r\n      error: false,\r\n      errorMsg: \"\",\r\n      loading: false,\r\n      loadingCode: true,\r\n      sended: false,\r\n      count: 60,\r\n      countButton: \"60 s\",\r\n      tipStyle: \"password-tip-none\",\r\n      strength: \"无\",\r\n      select: \"86\",\r\n      strengthValue: 0,\r\n      errorCode: \"\",\r\n      form: {\r\n        username: \"\",\r\n        password: \"\",\r\n        confirmPass: \"\",\r\n        mobile: \"\",\r\n        verifyCode: \"\",\r\n        verify: \"\"\r\n      },\r\n      rules: {\r\n        username: [\r\n          {\r\n            required: true,\r\n            message: \"账号不能为空\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        password: [\r\n          {\r\n            required: true,\r\n            message: \"密码不能为空\",\r\n            trigger: \"blur\"\r\n          },\r\n          {\r\n            validator: validatePassword,\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        confirmPass: [\r\n          {\r\n            required: true,\r\n            message: \"确认密码不能为空\",\r\n            trigger: \"blur\"\r\n          },\r\n          {\r\n            validator: validateConfirmPass,\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        mobile: [\r\n          {\r\n            required: true,\r\n            message: \"手机号不能为空\",\r\n            trigger: \"blur\"\r\n          },\r\n          {\r\n            validator: validateMobile,\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        verify: [\r\n          {\r\n            required: true,\r\n            message: \"验证码不能为空\",\r\n            trigger: \"blur\"\r\n          }\r\n        ]\r\n      }\r\n    };\r\n  },\r\n  methods: {\r\n    showErrorMsg(msg) {\r\n      this.error = true;\r\n      this.errorMsg = msg;\r\n    },\r\n    checkStrengthValue(v) {\r\n      // 评级制判断密码强度 最高5\r\n      let grade = 0;\r\n      if (/\\d/.test(v)) {\r\n        grade++; //数字\r\n      }\r\n      if (/[a-z]/.test(v)) {\r\n        grade++; //小写\r\n      }\r\n      if (/[A-Z]/.test(v)) {\r\n        grade++; //大写\r\n      }\r\n      if (/\\W/.test(v)) {\r\n        grade++; //特殊字符\r\n      }\r\n      if (v.length >= 10) {\r\n        grade++;\r\n      }\r\n      return grade;\r\n    },\r\n    strengthChange() {\r\n      if (!this.form.password) {\r\n        this.tipStyle = \"password-tip-none\";\r\n        this.strength = \"无\";\r\n        this.strengthValue = 0;\r\n        return;\r\n      }\r\n      let grade = this.checkStrengthValue(this.form.password);\r\n      if (grade <= 1) {\r\n        this.tipStyle = \"password-tip-weak\";\r\n        this.strength = \"弱\";\r\n        this.strengthValue = 33;\r\n      } else if (grade >= 2 && grade <= 4) {\r\n        this.tipStyle = \"password-tip-middle\";\r\n        this.strength = \"中\";\r\n        this.strengthValue = 66;\r\n      } else {\r\n        this.tipStyle = \"password-tip-strong\";\r\n        this.strength = \"强\";\r\n        this.strengthValue = 100;\r\n      }\r\n    },\r\n    sendVerify() {\r\n      this.$refs.registForm.validate(valid => {\r\n        if (valid) {\r\n          this.sended = true;\r\n          this.countDown();\r\n        }\r\n      });\r\n    },\r\n    countDown() {\r\n      let that = this;\r\n      if (this.count === 0) {\r\n        this.sended = false;\r\n        this.count = 60;\r\n        return;\r\n      } else {\r\n        this.countButton = this.count + \" s\";\r\n        this.count--;\r\n      }\r\n      setTimeout(function() {\r\n        that.countDown();\r\n      }, 1000);\r\n    },\r\n    submitRegist() {\r\n      this.$refs.registForm.validate(valid => {\r\n        if (valid) {\r\n          if (this.form.verifyCode === \"\") {\r\n            this.errorCode = \"验证码不能为空\";\r\n            return;\r\n          } else {\r\n            this.errorCode = \"\";\r\n          }\r\n          this.loading = true;\r\n          this.form.captchaId = this.captchaId;\r\n          this.form.passStrength = this.strength;\r\n          regist(this.form).then(res => {\r\n            this.loading = false;\r\n            if (res.success === true) {\r\n              let query = {\r\n                username: this.form.username\r\n              };\r\n              this.$router.push({\r\n                name: \"regist-result\",\r\n                query: query\r\n              });\r\n            } else {\r\n              this.getVerifyCode();\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    getVerifyCode() {\r\n      this.loadingCode = true;\r\n      initCaptcha().then(res => {\r\n        if (res.success === true) {\r\n          this.captchaId = res.result.captchaId;\r\n          this.verifyCodeImg = drawCodeImage + this.captchaId;\r\n          this.loadingCode = false;\r\n        }\r\n      });\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getVerifyCode();\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n@import \"./regist.less\";\r\n</style>\r\n"],"sourceRoot":"src/views/login"}]}